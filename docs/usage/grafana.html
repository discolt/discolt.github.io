<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="An Elasticsearch public cloud service , provides Simple Reliable and Professional search-services for enterprises.

">
    <title>ZSearch - Cloud Search </title>
    <link rel="icon" href="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ" type="image/x-icon">
    <link rel="shortcut icon" href="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="/index-132e2ae5-1.css"/>
    <link rel="stylesheet" type="text/css" href="/index-132e2ae5-2.css"/>
    
    <style id="nprogress-style">
      #nprogress { display: none }
    </style>
    <link rel="stylesheet/less" type="text/css" href="/color.less"/>
    <script src="https://gw.alipayobjects.com/os/lib/es6-shim/0.35.5/??es6-sham.min.js,es6-shim.min.js"></script>
    <!--[if lte IE 10]>
    <script src="https://as.alipayobjects.com/g/component/??console-polyfill/0.2.2/index.js,media-match/2.0.2/media.match.min.js"></script>
    <![endif]-->
    <script src="https://as.alipayobjects.com/g/component/intl/1.0.1/??Intl.min.js,locale-data/jsonp/en.js,locale-data/jsonp/zh.js"></script>
    <script>
    (function() {
      function isLocalStorageNameSupported() {
        var testKey = 'test';
        var storage = window.localStorage;
        try {
          storage.setItem(testKey, '1');
          storage.removeItem(testKey);
          return true;
        } catch (error) {
          return false;
        }
      }
      // 优先级提高到所有静态资源的前面，语言不对，加载其他静态资源没意义
      var pathname = location.pathname;

      function isZhCN(pathname) {
        return /-cn\/?$/.test(pathname);
      }
      function getLocalizedPathname(path, zhCN) {
        var pathname = path.startsWith('/') ? path : '/' + path;
        if (!zhCN) { // to enUS
          return /\/?index-cn/.test(pathname) ? '/' : pathname.replace('-cn', '');
        } else if (pathname === '/') {
          return '/index-cn';
        } else if (pathname.endsWith('/')) {
          return pathname.replace(/\/$/, '-cn/');
        }
        return pathname + '-cn';
      }

      // 兼容旧的 URL， `?locale=...`
      var queryString = location.search;
      if (queryString) {
        var isZhCNConfig = queryString.indexOf('zh-CN') > -1;
        if (isZhCNConfig && !isZhCN(pathname)) {
          location.pathname = getLocalizedPathname(pathname, isZhCNConfig)
        }
      }

      if (isLocalStorageNameSupported() && (pathname === '/' || pathname === '/index-cn')) {
        var lang = (window.localStorage && localStorage.getItem('locale')) || ((navigator.language || navigator.browserLanguage).toLowerCase() === 'zh-cn' ? 'zh-CN' : 'en-US');
        // safari is 'zh-cn', while other browser is 'zh-CN';
        if ((lang === 'zh-CN') !== isZhCN(pathname)) {
          location.pathname = getLocalizedPathname(pathname, lang === 'zh-CN');
        }
      }
      document.documentElement.className += isZhCN(pathname) ? 'zh-cn' : 'en-us';
    })()
    </script>
  </head>
  <body>
    <div id="react-content">
      <div class="page-wrapper" data-reactroot=""><header id="header" class="clearfix"><div class="ant-row"><div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-5 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a id="logo" href="/"><img alt="logo" src="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ"/><img alt="ZSearch" src="https://gw.alipayobjects.com/zos/basement_prod/6b9b339a-48f5-4af6-8cde-1ff57d1d2bb2.svg"/></a></div><div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-19 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><ul class="ant-menu menu-site ant-menu-light ant-menu-root ant-menu-horizontal" id="nav" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item hide-in-home-page" role="menuitem"><a href="/"><span>Home</span></a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/intro-open">产品</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-selected" role="menuitem"><a href="/docs/usage/connect">使用</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/price">价格</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/help">帮助</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="https://zsearch.cloud.alipay.com">控制台</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div></header><div class="main-wrapper"><div class="ant-row"><div class="ant-col main-menu ant-col-xs-24 ant-col-sm-24 ant-col-md-24 ant-col-lg-6 ant-col-xl-5 ant-col-xxl-4"><div><div class=""><section class="main-menu-inner"><ul class="ant-menu aside-container menu-site ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open ant-menu-submenu-selected" role="menuitem"><div style="padding-left:40px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="生态$Menu" aria-haspopup="true"><h4>生态</h4><i class="ant-menu-submenu-arrow"></i></div><ul id="生态$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/connect"><span>连接</span><span class="chinese">connect</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/kibana"><span>Kibana</span><span class="chinese">可视化分析</span></a></li><li class="ant-menu-item ant-menu-item-selected" role="menuitem" style="padding-left:80px"><a href="/docs/usage/grafana"><span>Grafana</span><span class="chinese">时序数据面板</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/logstash"><span>Logstash</span><span class="chinese">管道处理</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/file-beats"><span>File Beat</span><span class="chinese">文件数据采集</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/metric-beats"><span>Metric Beat</span><span class="chinese">度量数据采集</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/other-beats"><span>Other Beat</span><span class="chinese">其他采集工具</span></a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:40px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="API扩展$Menu" aria-haspopup="true"><h4>API扩展</h4><i class="ant-menu-submenu-arrow"></i></div><ul id="API扩展$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-join"><span>JoinedQuery (Beta)</span><span class="chinese"></span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-ranked"><span>RankedQuery</span><span class="chinese">自定义排位</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-roxima"><span>ProximaQuery</span><span class="chinese">向量检索</span></a></li></ul></li><li class="ant-menu-item" role="menuitem" style="padding-left:40px"><a href="/docs/usage/faq">FAQ</a></li></ul></section></div></div></div><div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-24 ant-col-lg-18 ant-col-xl-19 ant-col-xxl-20"><section class="main-container"><article class="markdown"><div data-show="true" class="ant-alert ant-alert-warning ant-alert-no-icon"><span class="ant-alert-message"><span>This article has not been translated yet. Wanna help us out? <a href="https://github.com/ant-design/ant-design/issues/1471">See this issue on GitHub.</a></span></span><span class="ant-alert-description"></span></div><h1>Grafana</h1><div class="toc-affix"><div class=""><ul class="toc"><li><a class="bisheng-toc-h2" href="#接入示例" title="接入示例">接入示例</a></li><li><a class="bisheng-toc-h2" href="#准备样本数据" title="准备样本数据">准备样本数据</a></li><li><a class="bisheng-toc-h2" href="#Grafana-制作图表" title="Grafana 制作图表">Grafana 制作图表</a></li></ul></div></div><section class="markdown"><p>Grafana 是一个开源指标分析和可视化套件，常用于可视化基础设施的性能数据和应用程序分析的时间序列数据。也可以应用于其他领域，包括工业传感器，家庭自动化，天气和过程控制。 本文通过简单示例展示如何使用 Grafana 连接 ZSearch 快速构建您的监控应用。</p><p><img src="https://cdn.nlark.com/yuque/0/2019/png/163907/1557059031411-cf6a7c67-fe56-4ae0-b819-5a57ad6538de.png" alt="image.png"/></p><blockquote><p>ZSearch 也使用 Grafana 作为后端的统一监控中心 </p></blockquote><h2 id="接入示例"><span>接入示例</span><a href="#接入示例" class="anchor">#</a></h2><p>Grafana 接入主要操作步骤如下：</p><ol><li><p>准备样本数据。</p></li><li><p>下载 Grafana。</p></li><li><p>连接ZSearch数据源绘制图表。</p></li></ol><h2 id="准备样本数据"><span>准备样本数据</span><a href="#准备样本数据" class="anchor">#</a></h2><ol><li><p>在 ZSearch 控制台创建日志型索引 monitor，表结构如下：
<img src="https://intranetproxy.alipay.com/skylark/lark/0/2019/png/596/1550212324766-e55daa8f-1724-49a2-ada9-06e94d2a141d.png#align=left&amp;display=inline&amp;height=232&amp;name=image.png&amp;originHeight=464&amp;originWidth=2256&amp;size=96874&amp;status=done&amp;width=1128" alt="image.png"/></p></li><li><p>准备样本数据 <code>request.json</code> 文件。</p></li></ol><pre class="language-json"><code><span class="token punctuation">{</span><span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"cpu"</span> <span class="token operator">:</span> <span class="token string">"10"</span><span class="token punctuation">,</span> <span class="token property">"memory"</span><span class="token operator">:</span><span class="token string">"18.2"</span><span class="token punctuation">,</span> <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2019-02-14T11:10:00Z"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"cpu"</span> <span class="token operator">:</span> <span class="token string">"22"</span><span class="token punctuation">,</span> <span class="token property">"memory"</span><span class="token operator">:</span><span class="token string">"23.2"</span><span class="token punctuation">,</span> <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2019-02-14T11:11:00Z"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"cpu"</span> <span class="token operator">:</span> <span class="token string">"32"</span><span class="token punctuation">,</span> <span class="token property">"memory"</span><span class="token operator">:</span><span class="token string">"48.2"</span><span class="token punctuation">,</span> <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2019-02-14T11:12:00Z"</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span><span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"cpu"</span> <span class="token operator">:</span> <span class="token string">"15"</span><span class="token punctuation">,</span> <span class="token property">"memory"</span><span class="token operator">:</span><span class="token string">"18.2"</span><span class="token punctuation">,</span> <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token string">"2019-02-14T11:13:00Z"</span> <span class="token punctuation">}</span></code></pre><ol><li><p>运行以下命令，上传样本数据到 ZSearch。</p></li></ol><p><strong>说明</strong>：username 和 password 分别对应 ZSearch 应用详情页的 <strong>用户名</strong> 和 <strong>密码</strong>。</p><pre class="language-shell"><code>curl <span class="token operator">-</span>u <span class="token variable">$username</span><span class="token punctuation">:</span><span class="token variable">$password</span> <span class="token operator">-</span>H <span class="token string">"Content-Type:application/json"</span>  http<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token variable">$server</span><span class="token operator">/</span>monitor<span class="token operator">/</span>_doc<span class="token operator">/</span>_bulk <span class="token operator">-</span><span class="token operator">-</span>data<span class="token operator">-</span>binary <span class="token variable">@request</span><span class="token punctuation">.</span>json</code></pre><h2 id="Grafana-制作图表"><span>Grafana 制作图表</span><a href="#Grafana-制作图表" class="anchor">#</a></h2><ol><li><p>进入官方首页，下载最新版本 <a href="https://grafana.com/grafana/download">Grafana</a>。</p></li><li><p>启动 Grafana，并访问 <a href="http://localhost:3000">http://localhost:3000</a>，进入控制台。</p></li><li><p>添加云搜数据源（Elasticsearch）。<img src="https://intranetproxy.alipay.com/skylark/lark/0/2019/png/596/1550212391393-4bb04522-898e-46ab-8049-292930155d08.png#align=left&amp;display=inline&amp;height=608&amp;name=image.png&amp;originHeight=1716&amp;originWidth=1522&amp;size=433119&amp;status=done&amp;width=539" alt="image.png"/></p></li><li><p>即可使用云搜数据源制作图表。<br/><img src="https://intranetproxy.alipay.com/skylark/lark/0/2019/png/596/1550212401150-57b9214d-aa4d-4fbd-b901-661290dca8fd.png#align=left&amp;display=inline&amp;height=250&amp;name=image.png&amp;originHeight=1232&amp;originWidth=2666&amp;size=520562&amp;status=done&amp;width=542" alt="image.png"/></p></li></ol></section><section class="markdown api-container"></section></article></section><section class="prev-next-nav"><a class="prev-page" href="/docs/usage/kibana"><i aria-label="icon: left" class="anticon anticon-left footer-nav-icon-before"><svg viewBox="64 64 896 896" class="" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i><span>Kibana</span><span class="chinese">可视化分析</span><i aria-label="icon: right" class="anticon anticon-right footer-nav-icon-after"><svg viewBox="64 64 896 896" class="" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a><a class="next-page" href="/docs/usage/logstash"><i aria-label="icon: left" class="anticon anticon-left footer-nav-icon-before"><svg viewBox="64 64 896 896" class="" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i><span>Logstash</span><span class="chinese">管道处理</span><i aria-label="icon: right" class="anticon anticon-right footer-nav-icon-after"><svg viewBox="64 64 896 896" class="" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></section><footer id="footer"><div class="footer-wrap"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>Resources</span></h2><div><a href="https://www.elastic.co/cn/">Elasticsearch</a><span> - </span>官网</div><div><a href="https://www.elastic.co/cn/products/beats">Beats</a><span> - </span>日志收集工具</div><div><a href="https://www.elastic.co/cn/products/logstash">Logstash</a><span> - </span>数据管道</div><div><a href="https://www.elastic.co/cn/products/kibana">Kibana</a><span> - </span>可视化展示</div><div><a href="https://grafana.com/">Grafana</a><span> - </span>时序监控面板</div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>Community</span></h2><div><a rel="noopener noreferrer" href="https://elasticsearch.cn/">Elasticsearch 中文站</a></div><div><a rel="noopener noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/index.html">Elasticsearch Reference</a></div><div><a>ZSearch 专栏</a><span> - </span>待建设</div><div><a><span>Work with Us</span></a><span> - </span>待建设</div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>Help</span></h2><div><a rel="noopener noreferrer" href="/docs/product/intro-quick-cn">快速开始</a></div><div><a rel="noopener noreferrer" href="/docs/usage/faq-cn">常见问题</a></div><div><a rel="noopener noreferrer" href="/docs/product/help-cn">在线帮助</a></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><img class="title-icon" src="https://gw.alipayobjects.com/zos/basement_prod/dc740028-449e-4fea-b90f-0f25de80fe8e.svg" alt="AFX Cloud"/><span>More Products</span></h2><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/MS">SOFA Mesh</a><span> - </span>微服务平台</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/OCEANBASE">OceanBase</a><span> - </span>分布式关系数据库</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/DTX">Seata</a><span> - </span>分布式事务</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/MPAAS">mPaaS</a><span> - </span>移动开发平台</div></div></div></div></div><div class="bottom-bar">蚂蚁金服 | 金融科技</div></footer></div></div></div></div>
    </div>
    <script src="/index-e3aeb897.js"></script>
    
    <!-- Global Site Tag (gtag.js) - Google Analytics
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-72788897-1"></script>
    <script>
    if (!location.port) {
      // Enable Google Analytics
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-72788897-1');
    }
    </script>
    -->
    <!-- Hotjar Tracking Code
    <script>
    (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:473408,hjsv:5};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    -->
  </body>
</html>
