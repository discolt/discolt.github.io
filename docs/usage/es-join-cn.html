<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="An Elasticsearch public cloud service , provides Simple Reliable and Professional search-services for enterprises.

">
    <title>ZSearch - Cloud Search </title>
    <link rel="icon" href="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ" type="image/x-icon">
    <link rel="shortcut icon" href="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ" type="image/x-icon">
    <link rel="stylesheet" type="text/css" href="/index-132e2ae5-1.css"/>
    <link rel="stylesheet" type="text/css" href="/index-132e2ae5-2.css"/>
    
    <style id="nprogress-style">
      #nprogress { display: none }
    </style>
    <link rel="stylesheet/less" type="text/css" href="/color.less"/>
    <script src="https://gw.alipayobjects.com/os/lib/es6-shim/0.35.5/??es6-sham.min.js,es6-shim.min.js"></script>
    <!--[if lte IE 10]>
    <script src="https://as.alipayobjects.com/g/component/??console-polyfill/0.2.2/index.js,media-match/2.0.2/media.match.min.js"></script>
    <![endif]-->
    <script src="https://as.alipayobjects.com/g/component/intl/1.0.1/??Intl.min.js,locale-data/jsonp/en.js,locale-data/jsonp/zh.js"></script>
    <script>
    (function() {
      function isLocalStorageNameSupported() {
        var testKey = 'test';
        var storage = window.localStorage;
        try {
          storage.setItem(testKey, '1');
          storage.removeItem(testKey);
          return true;
        } catch (error) {
          return false;
        }
      }
      // 优先级提高到所有静态资源的前面，语言不对，加载其他静态资源没意义
      var pathname = location.pathname;

      function isZhCN(pathname) {
        return /-cn\/?$/.test(pathname);
      }
      function getLocalizedPathname(path, zhCN) {
        var pathname = path.startsWith('/') ? path : '/' + path;
        if (!zhCN) { // to enUS
          return /\/?index-cn/.test(pathname) ? '/' : pathname.replace('-cn', '');
        } else if (pathname === '/') {
          return '/index-cn';
        } else if (pathname.endsWith('/')) {
          return pathname.replace(/\/$/, '-cn/');
        }
        return pathname + '-cn';
      }

      // 兼容旧的 URL， `?locale=...`
      var queryString = location.search;
      if (queryString) {
        var isZhCNConfig = queryString.indexOf('zh-CN') > -1;
        if (isZhCNConfig && !isZhCN(pathname)) {
          location.pathname = getLocalizedPathname(pathname, isZhCNConfig)
        }
      }

      if (isLocalStorageNameSupported() && (pathname === '/' || pathname === '/index-cn')) {
        var lang = (window.localStorage && localStorage.getItem('locale')) || ((navigator.language || navigator.browserLanguage).toLowerCase() === 'zh-cn' ? 'zh-CN' : 'en-US');
        // safari is 'zh-cn', while other browser is 'zh-CN';
        if ((lang === 'zh-CN') !== isZhCN(pathname)) {
          location.pathname = getLocalizedPathname(pathname, lang === 'zh-CN');
        }
      }
      document.documentElement.className += isZhCN(pathname) ? 'zh-cn' : 'en-us';
    })()
    </script>
  </head>
  <body>
    <div id="react-content">
      <div class="page-wrapper" data-reactroot=""><header id="header" class="clearfix"><div class="ant-row"><div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-5 ant-col-lg-5 ant-col-xl-5 ant-col-xxl-4"><a id="logo" href="/index-cn"><img alt="logo" src="https://gw.alipayobjects.com/mdn/rms_efc0e3/afts/img/A*OOKpR7EmECEAAAAAAAAAAABjARQnAQ"/><img alt="ZSearch" src="https://gw.alipayobjects.com/zos/basement_prod/6b9b339a-48f5-4af6-8cde-1ff57d1d2bb2.svg"/></a></div><div class="ant-col ant-col-xs-0 ant-col-sm-0 ant-col-md-19 ant-col-lg-19 ant-col-xl-19 ant-col-xxl-20"><ul class="ant-menu menu-site ant-menu-light ant-menu-root ant-menu-horizontal" id="nav" role="menu"><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item hide-in-home-page" role="menuitem"><a href="/index-cn"><span>首页</span></a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/intro-open-cn">产品</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item ant-menu-item-selected" role="menuitem"><a href="/docs/usage/connect-cn">使用</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/price-cn">价格</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="/docs/product/help-cn">帮助</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="display:none" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li><li class="ant-menu-item" role="menuitem"><a href="https://zsearch.cloud.alipay.com">控制台</a></li><li class="ant-menu-submenu ant-menu-submenu-horizontal ant-menu-overflowed-submenu" style="visibility:hidden;position:absolute" role="menuitem"><div class="ant-menu-submenu-title" aria-expanded="false" aria-haspopup="true"><span>···</span><i class="ant-menu-submenu-arrow"></i></div></li></ul></div></div></header><div class="main-wrapper"><div class="ant-row"><div class="ant-col main-menu ant-col-xs-24 ant-col-sm-24 ant-col-md-24 ant-col-lg-6 ant-col-xl-5 ant-col-xxl-4"><div><div class=""><section class="main-menu-inner"><ul class="ant-menu aside-container menu-site ant-menu-light ant-menu-root ant-menu-inline" role="menu"><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open" role="menuitem"><div style="padding-left:40px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="生态$Menu" aria-haspopup="true"><h4>生态</h4><i class="ant-menu-submenu-arrow"></i></div><ul id="生态$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/connect-cn"><span>连接</span><span class="chinese">connect</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/kibana-cn"><span>Kibana</span><span class="chinese">可视化分析</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/grafana-cn"><span>Grafana</span><span class="chinese">时序数据面板</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/logstash-cn"><span>Logstash</span><span class="chinese">管道处理</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/file-beats-cn"><span>File Beat</span><span class="chinese">文件数据采集</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/metric-beats-cn"><span>Metric Beat</span><span class="chinese">度量数据采集</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/other-beats-cn"><span>Other Beat</span><span class="chinese">其他采集工具</span></a></li></ul></li><li class="ant-menu-submenu ant-menu-submenu-inline ant-menu-submenu-open ant-menu-submenu-selected" role="menuitem"><div style="padding-left:40px" class="ant-menu-submenu-title" aria-expanded="true" aria-owns="API扩展$Menu" aria-haspopup="true"><h4>API扩展</h4><i class="ant-menu-submenu-arrow"></i></div><ul id="API扩展$Menu" class="ant-menu  ant-menu-sub ant-menu-inline" role="menu"><li class="ant-menu-item ant-menu-item-selected" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-join-cn"><span>JoinedQuery (Beta)</span><span class="chinese"></span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-ranked-cn"><span>RankedQuery</span><span class="chinese">自定义排位</span></a></li><li class="ant-menu-item" role="menuitem" style="padding-left:80px"><a href="/docs/usage/es-roxima-cn"><span>ProximaQuery</span><span class="chinese">向量检索</span></a></li></ul></li><li class="ant-menu-item" role="menuitem" style="padding-left:40px"><a href="/docs/usage/faq-cn">FAQ</a></li></ul></section></div></div></div><div class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-24 ant-col-lg-18 ant-col-xl-19 ant-col-xxl-20"><section class="main-container"><article class="markdown"><h1>JoinedQuery (Beta)</h1><section class="markdown"><p>JoinedQuery 从引擎层面实现了跨索引过滤功能，用以简化 ES 在多个索引间的关系处理。 Join基本上是基于共同属性的两组文档之间的semi-join，其中结果仅包含文档集合的一个属性。该连接用于过滤基于第二文档集的一个文档集，相当于SQL中的EXISTS算子。</p><h2 id="示例"><span>示例</span><a href="#示例" class="anchor">#</a></h2><ul><li><p>主表</p><ul><li><p>score : 成绩表</p></li></ul></li><li><p>子表</p><ul><li><p>user : 学生表</p></li><li><p>subject : 科目表</p></li></ul></li></ul><p>关联关系</p><pre class="language-null"><code>score<span class="token punctuation">.</span>user_id <span class="token operator">=</span> user<span class="token punctuation">.</span>id
score<span class="token punctuation">.</span>subject_id <span class="token operator">=</span> subject<span class="token punctuation">.</span>id</code></pre><p><strong>注意：</strong> 关联外键类型需使用数值类型（integer或long)</p></section><div class="toc-affix"><div class=""><ul class="toc"><li><a class="bisheng-toc-h2" href="#建表" title="建表">建表</a></li><li><a class="bisheng-toc-h2" href="#插入数据" title="插入数据">插入数据</a></li><li><a class="bisheng-toc-h2" href="#join检索" title="join检索">join检索</a></li><li><a class="bisheng-toc-h2" href="#重要说明" title="重要说明">重要说明</a></li></ul></div></div><section class="markdown"><h2 id="建表"><span>建表</span><a href="#建表" class="anchor">#</a></h2><pre class="language-json"><code>PUT score
<span class="token punctuation">{</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"_doc"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"score"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"integer"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"integer"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"integer"</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

PUT user
<span class="token punctuation">{</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"_doc"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"integer"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"keyword"</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

PUT subject
<span class="token punctuation">{</span>
  <span class="token property">"mappings"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"_doc"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"integer"</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
		<span class="token property">"name"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">"type"</span><span class="token operator">:</span><span class="token string">"keyword"</span><span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="插入数据"><span>插入数据</span><a href="#插入数据" class="anchor">#</a></h2><pre class="language-json"><code>POST user/_doc
<span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"jack"</span>
<span class="token punctuation">}</span>

POST user/_doc
<span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"rose"</span>
<span class="token punctuation">}</span>

POST subject/_doc
<span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"物理"</span>
<span class="token punctuation">}</span>

POST subject/_doc
<span class="token punctuation">{</span>
  <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"化学"</span>
<span class="token punctuation">}</span>

POST score/_bulk
<span class="token punctuation">{</span> <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"_doc"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"score"</span> <span class="token operator">:</span> <span class="token number">95</span><span class="token punctuation">,</span> <span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token number">1</span>  <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"_doc"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"score"</span> <span class="token operator">:</span> <span class="token number">66</span><span class="token punctuation">,</span> <span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token number">2</span>  <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"_doc"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"score"</span> <span class="token operator">:</span> <span class="token number">88</span><span class="token punctuation">,</span> <span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token number">1</span>  <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"index"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"_type"</span> <span class="token operator">:</span> <span class="token string">"_doc"</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">{</span> <span class="token property">"score"</span> <span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token number">2</span>  <span class="token punctuation">}</span></code></pre><h2 id="join检索"><span>join检索</span><a href="#join检索" class="anchor">#</a></h2><h3 id="案例1---查看-jack-的成绩表-(单表连接)"><span>案例1 - 查看 jack 的成绩表 (单表连接)</span><a href="#案例1---查看-jack-的成绩表-(单表连接)" class="anchor">#</a></h3><pre class="language-sql"><code><span class="token keyword">SELECT</span> score<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> score
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token keyword">user</span>
<span class="token keyword">ON</span> <span class="token keyword">user</span><span class="token punctuation">.</span>id<span class="token operator">=</span>score<span class="token punctuation">.</span>user_id
<span class="token keyword">WHERE</span> <span class="token keyword">user</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'jack'</span></code></pre><h4 id="By-JoinedQuery"><span>By JoinedQuery</span><a href="#By-JoinedQuery" class="anchor">#</a></h4><pre class="language-json"><code>GET score/_search
<span class="token punctuation">{</span>
	<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">"joined"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">"join"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
				<span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
					<span class="token property">"indices"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
					<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
					<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
						<span class="token property">"term"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"jack"</span> <span class="token punctuation">}</span>
					<span class="token punctuation">}</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h3 id="案例2--查看-jack-同学的物理成绩表-(多子表连接)"><span>案例2- 查看 jack 同学的物理成绩表 (多子表连接)</span><a href="#案例2--查看-jack-同学的物理成绩表-(多子表连接)" class="anchor">#</a></h3><pre class="language-sql"><code><span class="token keyword">SELECT</span> score<span class="token punctuation">.</span><span class="token operator">*</span> <span class="token keyword">FROM</span> score
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> <span class="token keyword">user</span>
<span class="token keyword">ON</span> <span class="token keyword">user</span><span class="token punctuation">.</span>id<span class="token operator">=</span>score<span class="token punctuation">.</span>user_id
<span class="token keyword">LEFT</span> <span class="token keyword">JOIN</span> subject
<span class="token keyword">ON</span> subject<span class="token punctuation">.</span>id<span class="token operator">=</span>score<span class="token punctuation">.</span>subject_id
<span class="token keyword">WHERE</span> <span class="token keyword">user</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'?'</span> <span class="token operator">AND</span> subject<span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token string">'?'</span></code></pre><h4 id="By-JoinedQuery"><span>By JoinedQuery</span><a href="#By-JoinedQuery" class="anchor">#</a></h4><pre class="language-json"><code>GET score/_search
<span class="token punctuation">{</span>
	<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
		<span class="token property">"joined"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
			<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
				<span class="token property">"match_all"</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
			<span class="token punctuation">}</span><span class="token punctuation">,</span>
			<span class="token property">"join"</span><span class="token operator">:</span> <span class="token punctuation">[</span>
			  <span class="token punctuation">{</span>
  				<span class="token property">"user_id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  					<span class="token property">"indices"</span><span class="token operator">:</span> <span class="token string">"user"</span><span class="token punctuation">,</span>
  					<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
  					<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  						<span class="token property">"term"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"jack"</span> <span class="token punctuation">}</span>
  					<span class="token punctuation">}</span>
  				<span class="token punctuation">}</span>
			  <span class="token punctuation">}</span><span class="token punctuation">,</span>
			  <span class="token punctuation">{</span>
  				<span class="token property">"subject_id"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  					<span class="token property">"indices"</span><span class="token operator">:</span> <span class="token string">"subject"</span><span class="token punctuation">,</span>
  					<span class="token property">"field"</span><span class="token operator">:</span> <span class="token string">"id"</span><span class="token punctuation">,</span>
  					<span class="token property">"query"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  						<span class="token property">"term"</span> <span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token property">"name"</span> <span class="token operator">:</span> <span class="token string">"物理"</span> <span class="token punctuation">}</span>
  					<span class="token punctuation">}</span>
  				<span class="token punctuation">}</span>
			  <span class="token punctuation">}</span>
			<span class="token punctuation">]</span>
		<span class="token punctuation">}</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre><h2 id="重要说明"><span>重要说明</span><a href="#重要说明" class="anchor">#</a></h2><ol><li><p><strong>关联字段类型</strong> 关联外键请使用数值类型（integer或long)。</p></li><li><p><strong>数据裁剪</strong> 出于对服务端的保护，join操作在取中间结果集时有个阈值保护，默认阈值为100万，超出阈值则中断查询，若发生截断SearchResponse会增加 ealy_terminated:true 提示检索数据被裁剪。</p></li></ol></section><section class="markdown api-container"></section></article></section><section class="prev-next-nav"><a class="prev-page" href="/docs/usage/other-beats-cn"><i aria-label="图标: left" class="anticon anticon-left footer-nav-icon-before"><svg viewBox="64 64 896 896" class="" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i><span>Other Beat</span><span class="chinese">其他采集工具</span><i aria-label="图标: right" class="anticon anticon-right footer-nav-icon-after"><svg viewBox="64 64 896 896" class="" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a><a class="next-page" href="/docs/usage/es-ranked-cn"><i aria-label="图标: left" class="anticon anticon-left footer-nav-icon-before"><svg viewBox="64 64 896 896" class="" data-icon="left" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M724 218.3V141c0-6.7-7.7-10.4-12.9-6.3L260.3 486.8a31.86 31.86 0 0 0 0 50.3l450.8 352.1c5.3 4.1 12.9.4 12.9-6.3v-77.3c0-4.9-2.3-9.6-6.1-12.6l-360-281 360-281.1c3.8-3 6.1-7.7 6.1-12.6z"></path></svg></i><span>RankedQuery</span><span class="chinese">自定义排位</span><i aria-label="图标: right" class="anticon anticon-right footer-nav-icon-after"><svg viewBox="64 64 896 896" class="" data-icon="right" width="1em" height="1em" fill="currentColor" aria-hidden="true" focusable="false"><path d="M765.7 486.8L314.9 134.7A7.97 7.97 0 0 0 302 141v77.3c0 4.9 2.3 9.6 6.1 12.6l360 281.1-360 281.1c-3.9 3-6.1 7.7-6.1 12.6V883c0 6.7 7.7 10.4 12.9 6.3l450.8-352.1a31.96 31.96 0 0 0 0-50.4z"></path></svg></i></a></section><footer id="footer"><div class="footer-wrap"><div class="ant-row" style="margin-left:-8px;margin-right:-8px"><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>相关资源</span></h2><div><a href="https://www.elastic.co/cn/">Elasticsearch</a><span> - </span>官网</div><div><a href="https://www.elastic.co/cn/products/beats">Beats</a><span> - </span>日志收集工具</div><div><a href="https://www.elastic.co/cn/products/logstash">Logstash</a><span> - </span>数据管道</div><div><a href="https://www.elastic.co/cn/products/kibana">Kibana</a><span> - </span>可视化展示</div><div><a href="https://grafana.com/">Grafana</a><span> - </span>时序监控面板</div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>社区</span></h2><div><a rel="noopener noreferrer" href="https://elasticsearch.cn/">Elasticsearch 中文站</a></div><div><a rel="noopener noreferrer" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/index.html">Elasticsearch Reference</a></div><div><a>ZSearch 专栏</a><span> - </span>待建设</div><div><a><span>加入我们</span></a><span> - </span>待建设</div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><span>帮助</span></h2><div><a rel="noopener noreferrer" href="/docs/product/intro-quick-cn">快速开始</a></div><div><a rel="noopener noreferrer" href="/docs/usage/faq-cn">常见问题</a></div><div><a rel="noopener noreferrer" href="/docs/product/help-cn">在线帮助</a></div></div></div><div style="padding-left:8px;padding-right:8px" class="ant-col ant-col-xs-24 ant-col-sm-24 ant-col-md-6"><div class="footer-center"><h2><img class="title-icon" src="https://gw.alipayobjects.com/zos/basement_prod/dc740028-449e-4fea-b90f-0f25de80fe8e.svg" alt="AFX Cloud"/><span>更多产品</span></h2><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/MS">SOFA Mesh</a><span> - </span>微服务平台</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/OCEANBASE">OceanBase</a><span> - </span>分布式关系数据库</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/DTX">Seata</a><span> - </span>分布式事务</div><div><a rel="noopener noreferrer" href="https://tech.antfin.com/products/MPAAS">mPaaS</a><span> - </span>移动开发平台</div></div></div></div></div><div class="bottom-bar">蚂蚁金服 | 金融科技</div></footer></div></div></div></div>
    </div>
    <script src="/index-e3aeb897.js"></script>
    
    <!-- Global Site Tag (gtag.js) - Google Analytics
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-72788897-1"></script>
    <script>
    if (!location.port) {
      // Enable Google Analytics
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-72788897-1');
    }
    </script>
    -->
    <!-- Hotjar Tracking Code
    <script>
    (function(h,o,t,j,a,r){
      h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
      h._hjSettings={hjid:473408,hjsv:5};
      a=o.getElementsByTagName('head')[0];
      r=o.createElement('script');r.async=1;
      r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
      a.appendChild(r);
    })(window,document,'//static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    -->
  </body>
</html>
